# Name: fw_cat_restriction v1.0 
# Type: Admin plugin
# Restrict Article Categories for Sections in Write Panel
# Author: Superfly
# URL: http://www.flyweb.at
# Recommended load order: 5

# .....................................................................
# This is a plugin for Textpattern CMS - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# .....................................................................

YToxMTp7czo0OiJuYW1lIjtzOjE4OiJmd19jYXRfcmVzdHJpY3Rpb24iO3M6NjoiYXV0aG9y
IjtzOjg6IlN1cGVyZmx5IjtzOjEwOiJhdXRob3JfdXJpIjtzOjIwOiJodHRwOi8vd3d3LmZs
eXdlYi5hdCI7czo3OiJ2ZXJzaW9uIjtzOjM6IjEuMCI7czoxMToiZGVzY3JpcHRpb24iO3M6
NTU6IlJlc3RyaWN0IEFydGljbGUgQ2F0ZWdvcmllcyBmb3IgU2VjdGlvbnMgaW4gV3JpdGUg
UGFuZWwiO3M6NDoiY29kZSI7czoxMTA5MjoiLyoqDQogKg0KICogVGV4dHBhdHRlcm4gQ01T
IFBsdWdpbiA8d3d3LnRleHRwYXR0ZXJuLmNvbT4NCiAqDQogKiBmd19jYXRfcmVzdHJpY3Rp
b24ucGhwDQogKiBGbHl3ZWIgQ2F0ZWdvcmllcyBSZXN0cmljdGlvbiBQbHVnaW4NCiAqDQog
KiBUaGlzIFBsdWdpbiBpcyBmb3IgdGhlIENNUyBXcml0ZSBQYW5lbC4gSXQgY2FuIGRlYWN0
aXZhdGUgQ2F0ZWdvcnkNCiAqIE5hbWVzIHJlbGF0aXZlIHRvIFNlY3Rpb25zIE5hbWVzLg0K
ICoNCiAqIEBhdXRob3IgZmx5d2ViIHByb2R1Y3Rpb25zIDx3d3cuZmx5d2ViLmF0Pg0KICog
QGNvcHlyaWdodCAyMDE1IGZseXdlYiBwcm9kdWN0aW9ucw0KICogQGxpY2Vuc2UgaHR0cDov
L29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVCAtIE1JVCBMaWNlbnNlIChNSVQpDQogKiBA
dmVyc2lvbiAxLjANCiAqDQogKi8NCg0KaWYgKHR4cGludGVyZmFjZSA9PT0gJ2FkbWluJykg
ew0KDQoJYWRkX3ByaXZzKCdmd19jYXRfcmVzdHJpY3Rpb24nLCcxJyk7DQoJYWRkX3ByaXZz
KCdwbHVnaW5fcHJlZnMuZndfY2F0X3Jlc3RyaWN0aW9uJywgJzEnKTsNCg0KCXJlZ2lzdGVy
X3RhYigiZXh0ZW5zaW9ucyIsICJmd19jYXRfcmVzdHJpY3Rpb24iLCAnQ2F0ZWdvcnkgUmVz
dHJpY3Rpb25zJyk7DQoNCglyZWdpc3Rlcl9jYWxsYmFjaygnZndfY2F0X3Jlc3RyaWN0aW9u
JywgJ3BsdWdpbl9saWZlY3ljbGUuZndfY2F0X3Jlc3RyaWN0aW9uJywgJ2luc3RhbGxlZCcp
Ow0KCXJlZ2lzdGVyX2NhbGxiYWNrKCdmd19jYXRfcmVzdHJpY3Rpb24nLCAncGx1Z2luX2xp
ZmVjeWNsZS5md19jYXRfcmVzdHJpY3Rpb24nLCAnZGVsZXRlZCcpOw0KCXJlZ2lzdGVyX2Nh
bGxiYWNrKCdmd19jYXRfcmVzdHJpY3Rpb24nLCAncGx1Z2luX3ByZWZzLmZ3X2NhdF9yZXN0
cmljdGlvbicpOw0KCXJlZ2lzdGVyX2NhbGxiYWNrKCdmd19jYXRfcmVzdHJpY3Rpb24nLCAn
YXJ0aWNsZV91aScsJ3NvcnRfZGlzcGxheScpOw0KCXJlZ2lzdGVyX2NhbGxiYWNrKCdmd19j
YXRfcmVzdHJpY3Rpb24nLCAnZndfY2F0X3Jlc3RyaWN0aW9uJyk7DQoNCn0NCg0KLyoqDQog
Kg0KICogZndfY2F0X3Jlc3RyaWN0aW9uIC0gUGx1Z2luIEZhY3RvcnkgRnVuY3Rpb24NCiAq
DQogKiBAcGFyYW0gIHN0cmluZyAkZXZlbnQgLSBUZXh0cGF0dGVybiBFdmVudCBDYWxsYmFj
ayBQYXJhbWV0ZXINCiAqIEBwYXJhbSAgc3RyaW5nICRzdGVwIC0gVGV4dHBhdHRlcm4gU3Rl
cCBDYWxsYmFjayBQYXJhbWV0ZXINCiAqDQogKi8NCmZ1bmN0aW9uIGZ3X2NhdF9yZXN0cmlj
dGlvbigkZXZlbnQsICRzdGVwKXsNCg0KCSRmd19jYXRfcmVzdHJpY3Rpb24gPSAgbmV3IGZ3
X2NhdF9yZXN0cmljdGlvbkNsYXNzKCk7DQoNCglzd2l0Y2ggKCRzdGVwKSB7DQoNCgkJY2Fz
ZSAnaW5zdGFsbGVkJzoNCgkJCSRmd19jYXRfcmVzdHJpY3Rpb24tPmluc3RhbGwoKTsNCgkJ
CWJyZWFrOw0KDQoJCWNhc2UgJ2RlbGV0ZWQnOg0KCQkJJGZ3X2NhdF9yZXN0cmljdGlvbi0+
dW5pbnN0YWxsKCk7DQoJCQlicmVhazsNCg0KCQljYXNlICdzYXZlJzoNCgkJCSRmd19jYXRf
cmVzdHJpY3Rpb24tPmFkbWlucGFnZSgpOw0KCQkJYnJlYWs7DQoNCgkJY2FzZSAnc29ydF9k
aXNwbGF5JzoNCgkJCSRmd19jYXRfcmVzdHJpY3Rpb24tPmphdmFzY3JpcHQoKTsNCgkJCWJy
ZWFrOw0KDQoJCWRlZmF1bHQ6DQoJCQkkZndfY2F0X3Jlc3RyaWN0aW9uLT5hZG1pbnBhZ2Uo
KTsNCgkJCWJyZWFrOw0KDQoJfQ0KDQoJcmV0dXJuOw0KDQp9DQoNCg0KLyoqDQogKg0KICog
ZndfY2F0X3Jlc3RyaWN0aW9uQ2xhc3MNCiAqDQogKiBUaGlzIFBsdWdpbiBhZGRzIHRoZSBh
YmlsaXR5IHRvIHJlc3RyaWN0IENhdGVnb3JpZXMgZnJvbSBzcGVjaWZpYyBTZWN0aW9ucyBp
biB0aGUgV3JpdGUgVGFiDQogKg0KICoNCiAqIEB2ZXJzaW9uIDEuMA0KICogQGF1dGhvciBT
dXBlcmZseSA8d3d3LmZseXdlYi5hdD4NCiAqIEBwcm9qZWN0IFRleHRwYXR0ZXJuIEFkbWlu
IFBsdWdpbg0KICoNCiAqLw0KY2xhc3MgZndfY2F0X3Jlc3RyaWN0aW9uQ2xhc3Mgew0KDQoN
CgkvKioNCgkgKg0KCSAqIF9fY29uc3RydWN0DQoJICogQWRkcyBUaGVtZSBDbGFzcw0KCSAq
DQoJICovDQoJZnVuY3Rpb24gX19jb25zdHJ1Y3QoKXsNCg0KCQlnbG9iYWwgJHRoZW1lOw0K
CQkkdGhpcy0+dGhlbWUgPSAkdGhlbWU7DQoNCgl9DQoNCg0KCS8qKg0KCSAqDQoJICogSW5z
dGFsbCBEYXRhYmFzZSBUYWJsZSB0eHBfZndfY2F0X3Jlc3RyaWN0aW9uDQoJICoNCgkgKi8N
CglmdW5jdGlvbiBpbnN0YWxsKCkgew0KDQoJCWlmICghZ2V0VGhpbmdzKCJTaG93IHRhYmxl
cyBsaWtlICciIC4gUEZYIC4gInR4cF9md19jYXRfcmVzdHJpY3Rpb24nIikpIHsNCg0KCQkJ
Ly9maWd1cmUgb3V0IHdoYXQgTXlTUUwgdmVyc2lvbiB3ZSBhcmUgdXNpbmcgKGZyb20gX3Vw
ZGF0ZS5waHApDQoJCQkkbXlzcWx2ZXJzaW9uID0gbXlzcWxfZ2V0X3NlcnZlcl9pbmZvKCk7
DQoNCgkJCSR0YWJsZXR5cGUgPSAoIGludHZhbCgkbXlzcWx2ZXJzaW9uWzBdKSA+PSA1IHx8
IHByZWdfbWF0Y2goJyNeNFwuKDBcLlsyLTldfCgxWzg5XSkpfCgxXC5bMi05XSkjJywgJG15
c3FsdmVyc2lvbikpDQoJCQk/ICIgRU5HSU5FPU15SVNBTSAiDQoJCQkJCTogIiBUWVBFPU15
SVNBTSAiOw0KDQoJCQlpZiAoIGlzc2V0KCR0eHBjZmdbJ2RiY2hhcnNldCddKSAmJiAoaW50
dmFsKCRteXNxbHZlcnNpb25bMF0pID49IDUgfHwgcHJlZ19tYXRjaCgnI140XC5bMS05XSMn
LCAkbXlzcWx2ZXJzaW9uKSkpDQoJCQkJJHRhYmxldHlwZSAuPSAiIENIQVJBQ1RFUiBTRVQg
PSAiLiAkdHhwY2ZnWydkYmNoYXJzZXQnXSAuIiAiOw0KDQoJCQkvLyBDcmVhdGUgdGhlIHR4
cF9md19jYXRfcmVzdHJpY3Rpb25zIHRhYmxlDQoJCQkkZndfY2F0X3Jlc3RyaWN0aW9uc1Rh
YmxlID0gc2FmZV9xdWVyeSgiQ1JFQVRFIFRBQkxFIGAiIC4gUEZYIC4gInR4cF9md19jYXRf
cmVzdHJpY3Rpb25gICgNCgkJCQkJYGlkYCBpbnQoMTEpIE5PVCBOVUxMIEFVVE9fSU5DUkVN
RU5ULA0KCQkJCQlgc2VjdGlvbmAgVkFSQ0hBUigxMjgpIE5PVCBOVUxMLA0KCQkJCQlgY2F0
ZWdvcnlgIFZBUkNIQVIoNjQpIE5PVCBOVUxMLA0KCQkJCQlQUklNQVJZIEtFWSAoYGlkYCks
DQogIAkJCQkJVU5JUVVFIEtFWSBgaWRgIChgaWRgKQ0KCQkJKSAkdGFibGV0eXBlIik7DQoN
CgkJfQ0KDQoJfQ0KDQoNCgkvKioNCgkgKg0KCSAqIHVuaW5zdGFsbCAtIFVuaW5zdGFsbCBE
YXRhYmFzZSBUYWJsZSB0eHBfZndfY2F0X3Jlc3RyaWN0aW9uDQoJICoNCgkgKi8NCglmdW5j
dGlvbiB1bmluc3RhbGwoKSB7DQoNCgkJaWYgKGdldFRoaW5ncygiU2hvdyB0YWJsZXMgbGlr
ZSAnIiAuIFBGWCAuICJ0eHBfZndfY2F0X3Jlc3RyaWN0aW9uJyIpKSB7DQoNCgkJCSRzcWwg
PSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIiAuUEZYIC4gInR4cF9md19jYXRfcmVzdHJpY3Rp
b247ICI7DQoNCgkJCSRkcm9wID0gc2FmZV9xdWVyeSgkc3FsKTsNCg0KCQl9DQoNCgl9DQoN
CgkvKioNCgkgKg0KCSAqIFNhdmVzIENhdGVnb3JpZXMgZnJvbSBIVE1MIEZvcm0gdG8gRGF0
YWJhc2UNCgkgKg0KCSAqIEBwYXJhbSBzdHJpbmcgJF9QT1NUWydzZWN0aW9uJ10NCgkgKiBA
cGFyYW0gYXJyYXkgJF9QT1NUWydjYXRlZ29yaWVzJ10NCgkgKiBAdXNlcyBsaWIvdHhwbGli
X3RoZW1lLnBocCAtIGFubm91bmNlKCkNCgkgKiBAcmV0dXJuIHN0cmluZyAtIEFkbWluIFRo
ZW1lIE5vdGlmaWNhdGlvbiBtZXNzYWdlDQoJICoNCgkgKi8NCglmdW5jdGlvbiBzYXZlKCkg
ew0KDQoJCSRzZWN0aW9uID0gZ3BzKCdzZWN0aW9uJyk7DQoJCSRjYXRlZ29yaWVzID0gYXJy
YXlfZmlsdGVyKCBhcnJheV9tYXAoJ2FycmF5X2ZpbHRlcicsIGdwcygnY2F0ZWdvcmllcycp
KSApOw0KDQoJCSRzcWxDYXQgPSAnJzsNCgkJJHNxbERlbENhdCA9ICcnOw0KCQlpZiAoICFl
bXB0eSgkY2F0ZWdvcmllcykgKXsNCg0KCQkJZm9yZWFjaCAoJGNhdGVnb3JpZXMgYXMgJGNh
dGVnb3J5KSB7DQoNCgkJCQkkc3FsRGVsQ2F0IC49ICggIWVtcHR5KCRjYXRlZ29yeVsnaWQn
XSkgJiYgIWVtcHR5KCRjYXRlZ29yeVsnbmFtZSddKSA/ICJpZCAhPSAnIiAuICRjYXRlZ29y
eVsnaWQnXSAuICInIEFORCAiIDogJycpOw0KDQoJCQkJJHNxbENhdCAuPSAoIGVtcHR5KCRj
YXRlZ29yeVsnaWQnXSkgJiYgIWVtcHR5KCRjYXRlZ29yeVsnbmFtZSddKSA/ICIoJycsICci
IC4gJHNlY3Rpb24gLiAiJywgJyIgLiAkY2F0ZWdvcnlbJ25hbWUnXSAuICInKSwgIiA6ICcn
KTsNCg0KCQkJfQ0KDQoNCgkJCWlmICggIWVtcHR5KCRzcWxEZWxDYXQpICkNCgkJCQkkc3Fs
RGVsQ2F0ID0gJ0FORCAoJyAuIHRyaW0oJHNxbERlbENhdCwgJ0FORCAnKSAuICcpJzsNCg0K
CQkJJHNxbERlbCA9ICJERUxFVEUgRlJPTSAiIC4gUEZYIC4gInR4cF9md19jYXRfcmVzdHJp
Y3Rpb24gV0hFUkUgc2VjdGlvbj0nIiAuICRzZWN0aW9uIC4gIiciIC4gJHNxbERlbENhdDsN
CgkJCSRkZWxldGUgPSBzYWZlX3F1ZXJ5KCRzcWxEZWwpOw0KDQoNCgkJCSRzcWxDYXQgPSB0
cmltKCRzcWxDYXQsICcsICcpOw0KCQkJaWYgKCAhZW1wdHkoJHNxbENhdCkgKXsNCg0KCQkJ
CSRzcWwgPSAiSU5TRVJUIElOVE8gIiAuIFBGWCAuICJ0eHBfZndfY2F0X3Jlc3RyaWN0aW9u
IFZBTFVFUyAiIC4gJHNxbENhdDsNCgkJCQkkaW5zZXJ0ID0gc2FmZV9xdWVyeSgkc3FsKTsN
Cg0KCQkJfQ0KDQoJCQlyZXR1cm4gJHRoaXMtPnRoZW1lLT5hbm5vdW5jZSggJ1NhdmVkIHJl
c3RyaWN0ZWQgQ2F0ZWdyb2llcycgKTsNCg0KCQl9DQoNCg0KCX0NCg0KCS8qKg0KCSAqDQoJ
ICogTG9hZHMgYWxsIHJlc3RyaWN0ZXQgQ2F0Z29yaWVzIGZyb20gdGhlIGRhdGFiYXNlIGFu
ZCBjb252ZXJ0cyB0aGUgcmVzdWx0IHRvIEpTT04NCgkgKg0KCSAqIEByZXR1cm4gc3RyaW5n
ICRyZXN0cmljdGlvbiAtIEpTT04gRW5jb2RlZCBSZXN1bHQ6IEtleSBpcyBTZWN0aW9ubmFt
ZSAtIFZhbHVlcyBhcmUgQ2F0ZWdvcnkgTmFtZSBhbmQgSUQNCgkgKg0KCSAqLw0KCWZ1bmN0
aW9uIHJlc3RyaWN0aW9uc19KU09OKCkgew0KDQoJCSRzcWwgPSAiU0VMRUNUICogRlJPTSAi
IC4gUEZYIC4gInR4cF9md19jYXRfcmVzdHJpY3Rpb24gT1JERVIgQlkgc2VjdGlvbiBERVND
IjsNCg0KCQkkcmVzdWx0ID0gZ2V0Um93cygkc3FsKTsNCg0KCQlpZiAoICRyZXN1bHQgPT0g
dHJ1ZSApew0KDQoJCQkkaT0xOyAvLyBOVE1TOiB3ZSBjYW50IHVzZSB0aGUgYXJyYXkga2V5
LCBiZWNhdXNlIGpzb25fZW5jb2RlKCkgbWFrZXMgYW4gYXJyYXkgd2l0aCBrZXkgJzAnLCBh
bmQgbm90IGFuIG9iamVjdA0KCQkJZm9yZWFjaCAoJHJlc3VsdCBhcyAkaXRlbSkgew0KDQoJ
CQkJJGZpbHRlckl0ZW1bICRpdGVtWydzZWN0aW9uJ10gXVskaV1bJ25hbWUnXSA9ICRpdGVt
WydjYXRlZ29yeSddOw0KCQkJCSRmaWx0ZXJJdGVtWyAkaXRlbVsnc2VjdGlvbiddIF1bJGld
WydpZCddID0gJGl0ZW1bJ2lkJ107DQoJCQkJJGkrKzsNCg0KCQkJfQ0KDQoJCQkkcmVzdHJp
Y3Rpb24gPSBqc29uX2VuY29kZSggJGZpbHRlckl0ZW0gKTsNCg0KCQl9IGVsc2UNCgkJCSRy
ZXN0cmljdGlvbiA9ICJbe31dIjsNCg0KCQlyZXR1cm4gJHJlc3RyaWN0aW9uOw0KDQoNCgl9
DQoNCg0KCS8qKg0KCSAqDQoJICogYWRtaW5wYWdlIC0gQWRtaW4gUGFnZSB0byBjb25maWd1
cmUgYW5kIHNhdmUgcmVzdHJpY3RldCBjYXRlZ29yaWVzDQoJICoNCgkgKiBAcmV0dXJuIHN0
cmluZyBIVE1MIENvZGUNCgkgKg0KCSAqLw0KCWZ1bmN0aW9uIGFkbWlucGFnZSgpIHsNCg0K
DQoJCWlmICggIWVtcHR5KCAkX1BPU1RbJ3N0ZXAnXSApID09ICdzYXZlJyApDQoJCQkkc2F2
ZU1zZyA9ICR0aGlzLT5zYXZlKCk7DQoNCg0KCQlwYWdldG9wKCAnQXJ0aWNsZSBDYXRlZ29y
eSBSZXN0cmljdGlvbnMnICk7DQoNCgkJZWNobyAnPGRpdiBjbGFzcz0idGV4dC1jb2x1bW4i
PicgLiAiXG4iOw0KDQoJCQllY2hvICc8aDE+Q2F0ZWdvcnkgUmVzdHJpY3Rpb25zPC9oMT4n
IC4gIlxuIjsNCgkJCWVjaG8gJzxwPlRoaXMgcGx1Z2luIG9ubHkgd29ya3Mgd2l0aCBBcnRp
Y2xlLUNhdGVnb3JpZXMuIE9ubHkgcGFyZW50IGNhdGVnb3JpZXMgY2FuIGJlIGRpc2FibGVk
LiBTdWItY2F0ZWdvcmllcyBnZXQgYXV0b21hdGljYWxseSBkaXNhYmxlZCBpZiBQYXJlbnQt
Q2F0ZWdvcnkgaXMgZGlzYWJsZWQuPC9wPjxici8+JyAuICJcbiI7DQoJCQllY2hvICc8c3R5
bGUgdHlwZT0idGV4dC9jc3MiPmxhYmVsIHtkaXNwbGF5OmJsb2NrOyBjdXJzb3I6cG9pbnRl
cjt9PC9zdHlsZT4nIC4gIlxuIjsNCg0KCQkJZWNobyBmb3JtKA0KDQoJCQkJCXN0YXJ0VGFi
bGUoJycsICdsZWZ0JywgJ3R4cC1saXN0JywgJzUnLCAnMzAlJykgLg0KDQoJCQkJCQknPHRo
ZWFkPicuICB0ciAoIGhDZWxsKCdDaG9vc2UgYSBzZWN0aW9uIGFuZCBkaXNhYmxlIHRoZSBk
ZXNpcmVkIGNhdGVnb3JpZXMnLCBudWxsKSApIC4gJzwvdGhlYWQ+Jy4NCg0KCQkJCQkJdHIo
IHRkYSgkdGhpcy0+c2VjdGlvbnNfZHJvcGRvd24oKSwgJyBjbGFzcz0iYWxpZ24tY2VudGVy
IicpICkNCg0KCQkJCQkJLiAkdGhpcy0+Y2F0ZWdvcmllc19jaGVja2JveGVzKCkgLg0KDQoJ
CQkJCQl0cigNCgkJCQkJCQl0ZGEoDQoJCQkJCQkJCSc8cD4nIC4gZklucHV0KCAnc3VibWl0
JywgJ3NhdmUnLCAnU2F2ZSBDYXRlZ29yaWVzJywgJ3B1Ymxpc2gnICApIC4gJzwvcD4nIC4N
CgkJCQkJCQkJc0lucHV0KCAnc2F2ZScgKSAuDQoJCQkJCQkJCWVJbnB1dCggJ2Z3X2NhdF9y
ZXN0cmljdGlvbicgKSwNCgkJCQkJCQkJJyBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXIiJw0K
CQkJCQkJCSkNCgkJCQkJCSkgLg0KDQoJCQkJCWVuZFRhYmxlKCksDQoJCQkJCW51bGwsDQoJ
CQkJCW51bGwsDQoJCQkJCSdwb3N0JywNCgkJCQkJbnVsbCwNCgkJCQkJbnVsbCwNCgkJCQkJ
J3RoZUZvcm0nDQoNCgkJCSk7IC8vIGZvcm0oKSBFTkQNCg0KCQllY2hvICc8L2Rpdj48YnIg
Y2xlYXI9ImFsbCIvPic7DQoNCgkJZWNobyAkdGhpcy0+amF2YXNjcmlwdCgnY2hlY2tib3gn
KTsNCg0KCQllY2hvICc8YnI+PHAgYWxpZ249ImNlbnRlciI+PHNtYWxsPlRoaXMgUGx1Z2lu
IHdhcyBtYWRlIGJ5ICcgLiBocmVmKCdmbHl3ZWIgUHJvZHVjdGlvbnMnLCAnaHR0cDovL3d3
dy5mbHl3ZWIuYXQnKSAuICcuPC9zbWFsbD48L3A+JyAuICJcbiI7DQoNCgkJaWYgKCFlbXB0
eSgkc2F2ZU1zZykpDQoJCQllY2hvICRzYXZlTXNnOw0KDQoJfQ0KDQoNCgkvKioNCgkgKg0K
CSAqIEhUTUwgRHJvcGRvd24gTWVudSB3aXRoIFNlY3Rpb24gTmFtZXMNCgkgKg0KCSAqIEBw
YXJhbSBzdHJpbmcgJF9QT1NUWydzZWN0aW9uXSAtIElmIHByZXNlbnQgU2VjdGlvbiBnZXRz
IHByZXNlbGVjdGVkIGluIERyb3Bkb3duIE1lbnUNCgkgKiBAcmV0dXJuIHN0cmluZyAkZHJv
cGRvd24gLSBIVE1MIERyb3Bkb3duIE1lbnUNCgkgKg0KCSAqLw0KCWZ1bmN0aW9uIHNlY3Rp
b25zX2Ryb3Bkb3duKCkgew0KDQoJCSRkcm9wZG93biA9ICcnOw0KCQkkc2VjdGlvbiA9IGdw
cygnc2VjdGlvbicpOw0KDQoJCSRnZXRTZWN0aW9ucyA9IHNhZmVfY29sdW1uKCduYW1lJywg
UEZYIC4gJ3R4cF9zZWN0aW9uJywgIm5hbWUgIT0gJ2RlZmF1bHQnIik7DQoNCgkJaWYgKCRn
ZXRTZWN0aW9ucykgew0KDQoJCQkkZHJvcGRvd24gLj0gJzxsYWJlbCBmb3I9InNlY3Rpb24i
PlNlY3Rpb24gJyAuICJcbiI7DQoJCQkkZHJvcGRvd24gLj0gc2VsZWN0SW5wdXQoJ3NlY3Rp
b24nLCAkZ2V0U2VjdGlvbnMsICRzZWN0aW9uLCBmYWxzZSwgJycsICdzZWN0aW9uJyk7DQoJ
CQkkZHJvcGRvd24gLj0gJzwvbGFiZWw+JyAuICJcbiI7DQoNCgkJfQ0KDQoJCXJldHVybiAk
ZHJvcGRvd247DQoNCgl9DQoNCg0KCS8qKg0KCSAqDQoJICogSFRNTCBUYWJsZSBSb3dzIHdp
dGggQ2F0ZWdwb3JpZSBDaGVja2JveGVzIGZvciBnaXZlbiBTZWN0aW9uDQoJICoNCgkgKiBA
cmV0dXJuIHN0cmluZyAkcm93cw0KCSAqDQoJICovDQoJZnVuY3Rpb24gY2F0ZWdvcmllc19j
aGVja2JveGVzKCkgew0KDQoJCSRyb3dzID0gJyc7DQoNCgkJJGdldENhdGVnb3JpZXMgPSBn
ZXRUcmVlKCdyb290JywgJ2FydGljbGUnKTsNCg0KCQlpZiAoJGdldENhdGVnb3JpZXMpIHsN
Cg0KCQkJZm9yZWFjaCAoJGdldENhdGVnb3JpZXMgYXMgJGNhdEtleSA9PiAkY2F0ZWdvcnkp
IHsNCg0KCQkJCWlmICggJGNhdGVnb3J5WydwYXJlbnQnXSA9PSAncm9vdCcgKXsNCg0KCQkJ
CQkkY2VsbCA9DQoJCQkJCQl0ZGEoDQoJCQkJCQkJJzxsYWJlbCBmb3I9ImNhdC0nIC4gJGNh
dGVnb3J5WyduYW1lJ10gLiAnIj4nIC4NCgkJCQkJCQljaGVja2JveCgnY2F0ZWdvcmllc1sn
IC4gJGNhdEtleSAuICddW25hbWVdJywgJGNhdGVnb3J5WyduYW1lJ10sIDAsIG51bGwsICdj
YXQtJyAuICRjYXRlZ29yeVsnbmFtZSddKSAuDQoJCQkJCQkJJGNhdGVnb3J5Wyd0aXRsZSdd
IC4gJzwvbGFiZWw+JyAuDQoJCQkJCQkJaElucHV0KCAnY2F0ZWdvcmllc1snIC4gJGNhdEtl
eSAuICddW2lkXScsICcnKQ0KCQkJCQkJKTsNCg0KCQkJCX0gZWxzZSB7DQoNCgkJCQkJJGNl
bGwgPSB0ZGEoICcmIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDsmIzE2MDsnIC4gJGNh
dGVnb3J5Wyd0aXRsZSddKTsNCg0KCQkJCX0NCg0KCQkJCSRyb3dzIC49IHRyKCAkY2VsbCAp
Ow0KCQkJfQ0KDQoJCX0NCg0KCQlyZXR1cm4gJHJvd3M7DQoNCgl9DQoNCg0KCS8qKg0KCSAq
DQoJICogamF2YXNjcmlwdCAtIEphdmFzY3JpcHQgRnVuY3Rpb25zIGZvciBXcml0ZSBQYW5l
bCBhbmQgQWRtaW4gUGFnZS4NCgkgKg0KCSAqIEBwYXJhbSAgc3RyaW5nICRlbGVtZW50IC0g
U2V0IEpTLUZ1bmN0aW9uIGZvciAiZHJvcGRvd24iIChXcml0ZSBQYW5lbCkgb3IgImNoZWNr
Ym94IiAoQWRtaW4gUGFnZSkNCgkgKiBAdXNlcyBqUXVlcnkNCgkgKiBAcmV0dXJuIHN0cmlu
ZyAkanMgLSBKYXZhc2NyaXB0DQoJICoNCgkgKi8NCglmdW5jdGlvbiBqYXZhc2NyaXB0KCRl
bGVtZW50PSdkcm9wZG93bicpIHsNCg0KCQkkSlNPTiA9ICR0aGlzLT5yZXN0cmljdGlvbnNf
SlNPTigpOw0KDQoJCSRqcyA9ICI8c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj4N
Cg0KCQkJalF1ZXJ5KGZ1bmN0aW9uKCkgew0KDQoJCQkJdmFyIGZpbHRlciA9IEpTT04ucGFy
c2UoJyRKU09OJyk7DQoNCg0KCQkJCSQoJyNzZWN0aW9uJykuY2hhbmdlKCBmdW5jdGlvbigp
IHsNCg0KCQkJCQlpZiggZmlsdGVyLmhhc093blByb3BlcnR5KHRoaXMudmFsdWUpID09IHRy
dWUgKXsNCg0KCQkJCQkJY2F0T2JqID0gZmlsdGVyW3RoaXMudmFsdWVdOw0KDQoJCQkJCX0g
ZWxzZSB7DQoNCgkJCQkJCWNhdE9iaiA9IFtdOw0KDQoJCQkJCX0NCg0KCQkJCQlmd19jYXRf
JGVsZW1lbnQoY2F0T2JqKTsNCg0KDQoJCQkJfSkuY2hhbmdlKCk7DQoNCg0KDQoJCQkJJChc
ImlucHV0W2lkXj0nY2F0LSddXCIpLmNoYW5nZSggZnVuY3Rpb24oKSB7DQoNCgkJCQkJCSQo
dGhpcykucGFyZW50cygndHInKS50b2dnbGVDbGFzcygnc2VsZWN0ZWQnKTsNCg0KCQkJCQl9
DQoNCgkJCQkpOw0KDQoNCg0KCQkJCWZ1bmN0aW9uIGZ3X2NhdF9jaGVja2JveChjYXRPYmop
IHsNCg0KCQkJCQkkKFwiaW5wdXRbaWRePSdjYXQtJ11cIikucHJvcCgnY2hlY2tlZCcsIGZh
bHNlKTsNCgkJCQkJJChcImlucHV0W2lkXj0nY2F0LSddXCIpLnBhcmVudHMoJ3RyJykucmVt
b3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7DQoJCQkJCSQoXCJpbnB1dFtpZF49J2NhdC0nXVwiKS5w
YXJlbnQoKS5uZXh0KCdpbnB1dCcpLnByb3AoJ3ZhbHVlJywgJycpOw0KDQoJCQkJCU9iamVj
dC5rZXlzKGNhdE9iaikuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7DQoNCgkJCQkJICAgIHZh
ciB2YWwgPSBjYXRPYmpba2V5XTsNCg0KCQkJCQkJJChcIiNjYXQtXCIgKyB2YWwubmFtZSku
cHJvcCgnY2hlY2tlZCcsIHRydWUpOw0KCQkJCQkJJChcIiNjYXQtXCIgKyB2YWwubmFtZSku
cGFyZW50cygndHInKS5hZGRDbGFzcygnc2VsZWN0ZWQnKTsNCgkJCQkJCSQoXCIjY2F0LVwi
ICsgdmFsLm5hbWUpLnBhcmVudCgpLm5leHQoJ2lucHV0JykucHJvcCgndmFsdWUnLCB2YWwu
aWQpOw0KDQoJCQkJCX0pOw0KDQoJCQkJfTsNCg0KDQoJCQkJZnVuY3Rpb24gZndfY2F0X2Ry
b3Bkb3duKGNhdE9iaikgew0KDQoJCQkJCSQoXCJzZWxlY3RbbmFtZT0nQ2F0ZWdvcnkxJ10g
b3B0aW9uOmd0KDApLCBzZWxlY3RbbmFtZT0nQ2F0ZWdvcnkyJ10gb3B0aW9uOmd0KDApXCIp
LmF0dHIoJ2Rpc2FibGVkJywgZmFsc2UpOw0KCQkJCQkkKFwic2VsZWN0W25hbWU9J0NhdGVn
b3J5MSddIG9wdGlvbjpndCgwKSwgc2VsZWN0W25hbWU9J0NhdGVnb3J5MiddIG9wdGlvbjpn
dCgwKVwiKS5jc3MoeyAnYmFja2dyb3VuZC1jb2xvcic6ICd3aGl0ZScsICdjb2xvcic6ICdi
bGFjayd9KTsNCg0KCQkJCQlPYmplY3Qua2V5cyhjYXRPYmopLmZvckVhY2goZnVuY3Rpb24g
KGtleSkgew0KDQoJCQkJCSAgICB2YXIgdmFsID0gY2F0T2JqW2tleV07DQoNCgkJCQkJCSQo
XCJvcHRpb25bdmFsdWU9J1wiICsgdmFsLm5hbWUgKyBcIiddXCIpLmF0dHIoJ2Rpc2FibGVk
JywgJ2Rpc2FibGVkJyk7DQoJCQkJCQkkKFwib3B0aW9uW3ZhbHVlPSdcIiArIHZhbC5uYW1l
ICsgXCInXVwiKS5hdHRyKCdzZWxlY3RlZCcsIGZhbHNlKTsNCgkJCQkJCSQoXCJvcHRpb25b
dmFsdWU9J1wiICsgdmFsLm5hbWUgKyBcIiddXCIpLm5leHRVbnRpbCggJChcIiBvcHRpb246
bm90KDpjb250YWlucygnXHUwMGEwJykpIFwiKSApLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2Fi
bGVkJyk7DQoJCQkJCQkkKFwib3B0aW9uW3ZhbHVlPSdcIiArIHZhbC5uYW1lICsgXCInXVwi
KS5jc3MoeyAnYmFja2dyb3VuZC1jb2xvcic6ICdyZWQnLCAnY29sb3InOiAnd2hpdGUnfSk7
DQoJCQkJCQkkKFwib3B0aW9uW3ZhbHVlPSdcIiArIHZhbC5uYW1lICsgXCInXVwiKS5uZXh0
VW50aWwoICQoXCIgb3B0aW9uOm5vdCg6Y29udGFpbnMoJ1x1MDBhMCcpKSBcIikgKS5jc3Mo
e2JhY2tncm91bmRDb2xvcjogJ3JlZCcsIGNvbG9yOiAnd2hpdGUnfSk7DQoNCgkJCQkJfSk7
DQoNCgkJCQl9Ow0KDQoJCQl9KTs8L3NjcmlwdD4iOw0KDQoJCWVjaG8gJGpzOw0KDQoJfQ0K
DQoNCg0KfSAvLyBjbGFzcyBmd19jYXRfcmVzdHJpY3Rpb25zQ2xhc3MoKSBFTkQNCiI7czo0
OiJ0eXBlIjtzOjE6IjMiO3M6NToib3JkZXIiO3M6MToiNSI7czo1OiJmbGFncyI7czoxOiIz
IjtzOjQ6ImhlbHAiO3M6NTIyOiI8aDE+Q2F0ZWdvcnkgUmVzdHJpY3Rpb25zPC9oMT4KPHA+
V2l0aCB0aGlzIFBsdWdpbiB5b3UgY2FuIHJlc3RyaWN0IEFydGljbGUtQ2F0ZWdvcmllcyBm
cm9tIHNwZWNpZmljIHNlY3Rpb25zIGluIHRoZSBXcml0ZSBQYW5lbHMgQ2F0ZWdvcmllcyBE
cm9wZG93bnMuPC9wPgo8aDI+SW5zdGFsbGF0aW9uPC9oMj4KPHA+QWZ0ZXIgaW5zdGFsbGlu
ZyB0aGUgUGx1Z2luIHlvdSBjYW4gZmluZCB0aGUgU2V0dGluZ3MgUGFnZSAiQ2F0ZWdvcnkg
UmVzdHJpY3Rpb25zIiB1bmRlciB0aGUgRXh0ZW5zaW9ucyBUYWIuPC9wPgo8aDI+Q2hhbmdl
bG9nPC9oMj4KPHA+PHN0cm9uZz5WZXJzaW9uIDEuMDwvc3Ryb25nPiBJbml0aWFsIHJlbGVh
c2UgLSAgMDMuIEZlYi4gMjAxNTwvcD4KPGJyPjxicj48YnI+PGJyPjxicj48aHI+PHAgYWxp
Z249ImNlbnRlciI+PHNtYWxsPlRoaXMgUGx1Z2luIHdhcyBtYWRlIGJ5IDxhIGhyZWY9Imh0
dHA6Ly93d3cuZmx5d2ViLmF0Ij4gZmx5d2ViIFByb2R1Y3Rpb25zPC9hPi48L3NtYWxsPjwv
cD4iO3M6MzoibWQ1IjtzOjMyOiI0ZTAzNTEwYWFiNGQxNDJkYzE3ZGFiNDY2ODRhYjg5NyI7
fQ==
